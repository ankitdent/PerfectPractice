<script id="dataLayer-checkout">
  window.sgdAnalytics = {
    customerId: '{{customer.id}}',
    customerEmail: '{{checkout.email}}',
    customerPhone: '{{checkout.shipping_address.phone}}',
    pageType: "checkout - " + (window.Shopify.Checkout.isOrderStatusPage ? 'order status' : window.Shopify.Checkout.step)
  };
  
  {% if first_time_accessed %}
  window.sgdAnalytics.first_time_accessed = true;
  {% else %}
  window.sgdAnalytics.first_time_accessed = false;
  {% endif %}

   if("thank_you" === window.Shopify.Checkout.step){
    // console.log(dataLayer);
   // dataLayer.push({ ecommerce: null });
                  var ecommerce = {
                      'transaction_id' : {{ order.id }}
                      'currency': {{shop.currency | json}},
                      'value': (Number({{checkout.total_price}}) / 100).toFixed(2),
                      'items':[{% for line_item in checkout.line_items %}{
                          'item_id'        : {{line_item.product.id | json}},
                          'item_variant'    : {{line_item.variant.title | json}},
                          'item_name'      : {{line_item.product.title | json}},
                          'price'           : (Number({{line_item.variant.price}}) / 100).toFixed(2),
                          'item_brand'      : {{line_item.product.vendor | json}},
                          'quantity'        : {{line_item.quantity | json}},
                      },{% endfor %}],
                  };
                  dataLayer.push({
                    'event'    : 'purchase',
                    ecommerce
                  });
  }
  window.dataLayer = window.dataLayer || [];
!function(){"use strict";function e(e,t){var n=Object.keys(e);if(Object.getOwnPropertySymbols){var c=Object.getOwnPropertySymbols(e);t&&(c=c.filter((function(t){return Object.getOwnPropertyDescriptor(e,t).enumerable}))),n.push.apply(n,c)}return n}function t(t){for(var c=1;c<arguments.length;c++){var o=null!=arguments[c]?arguments[c]:{};c%2?e(Object(o),!0).forEach((function(e){n(t,e,o[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(o)):e(Object(o)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(o,e))}))}return t}function n(e,t,n){return t in e?Object.defineProperty(e,t,{value:n,enumerable:!0,configurable:!0,writable:!0}):e[t]=n,e}var c=function e(t,n){document.querySelectorAll(t).length<t.length?setTimeout(e.bind(null,t,n),50):n()};var o="thrasio-dl--tracked";!function(e,t){void 0===t&&(t={});var n=t.insertAt;if(e&&"undefined"!=typeof document){var c=document.head||document.getElementsByTagName("head")[0],o=document.createElement("style");o.type="text/css","top"===n&&c.firstChild?c.insertBefore(o,c.firstChild):c.appendChild(o),o.styleSheet?o.styleSheet.cssText=e:o.appendChild(document.createTextNode(e))}}(".thrasio-dl--tracked{box-sizing:inherit}");var r,i=function(e,t,n){e&&(e.classList.contains(o)||(e.addEventListener(t,n),e.classList.add(o)))},a=function(e){arguments[0].eventType="thrasio-dl",window.dataLayer.push.apply(window.dataLayer,arguments),window.dataLayer.push({event:"flush dataLayer",eventCategory:void 0,eventLabel:void 0,eventValue:void 0,ecommerce:void 0,attributes:void 0,eventType:void 0})},u=!1,l=function(){return{total:Shopify.Checkout.estimated_price,step:Shopify.Checkout.step}},d=function(){var e=document.getElementById("continue_button");i(e,"click",(function(){var n=e.querySelector(".btn__content").textContent;a({event:"click",eventCategory:"checkout",eventLabel:n,attributes:t({},l())})}));var n=document.querySelector(".step__footer__previous-link");i(n,"click",(function(){var e=n.querySelector(".step__footer__previous-link-content").textContent;a({event:"click",eventCategory:"checkout",eventLabel:e,attributes:t({},l())})})),document.querySelectorAll(".review-block__link").forEach((function(e){i(e,"click",(function(){a({event:"click",eventCategory:"checkout",eventLabel:e.querySelector(".visually-hidden").textContent,attributes:t({},l())})}))})),document.querySelectorAll(".breadcrumb__link").forEach((function(e){i(e,"click",(function(){a({event:"click",eventCategory:"checkout",eventLabel:e.textContent,attributes:t({},l())})}))})),i(document.querySelector(".order-summary-toggle__text"),"click",(function(){a({event:"click",eventCategory:"checkout",eventLabel:"Show order summary",attributes:t({},l())})})),function(){document.querySelectorAll("[data-reduction-form] .edit_checkout button.field__input-btn").forEach((function(e){i(e,"click",(function(){a({event:"apply discount",eventCategory:"checkout",eventLabel:document.querySelector("#checkout_reduction_code").value,attributes:t({},l())})}))}));var e=document.querySelector('button[type="submit"].tag__button');i(e,"click",(function(){a({event:"remove discount",eventCategory:"checkout",eventLabel:e.parentNode.querySelector(".reduction-code__text").textContent,attributes:t({},l())})}))}(),"contact_information"===window.Shopify.Checkout.step?(document.querySelectorAll('input[name*="checkout"]').forEach((function(e){e.addEventListener("input",(function(){u||(u=!0,a({event:"begin checkout",eventCategory:"checkout",attributes:t({},l())}))}))})),function(){var e=document.querySelector(".section--contact-information a");i(e,"click",(function(){a({event:"click",eventCategory:"checkout",eventLabel:"log in",attributes:t({},l())})}));var n=function(e){i(e,"change",(function(e){var n=document.querySelector('label[for="'.concat(e.target.getAttribute("id"),'"], span#').concat(e.target.getAttribute("aria-labelledby")));a({event:e.target.checked?"accept marketing":"decline marketing",eventCategory:"checkout",eventLabel:n.textContent.trim(),attributes:t({},l())})}))};document.querySelectorAll("#checkout_buyer_accepts_marketing").forEach(n),c(['input[name="ps_accepts_sms"]'],(function(){document.querySelectorAll('input[name="ps_accepts_sms"]').forEach(n)})),c(['[data-shopify-buttoncontainer] [data-testid="grid-cell"]'],(function(){document.querySelectorAll('[data-shopify-buttoncontainer] [data-testid="grid-cell"]').forEach((function(e){var n=e.querySelector('div[role="button"], button[type="submit"]');i(n,"click",(function(){a({event:"express checkout",eventCategory:"checkout",eventLabel:n.textContent.trim(),attributes:t({},l())})}))}))})),new MutationObserver((function(){})).observe(document.querySelector(".main__content"),{childList:!0})}()):"shipping_method"===window.Shopify.Checkout.step?c(['input[name="checkout[shipping_rate][id]"]'],(function(){document.querySelectorAll('input[name="checkout[shipping_rate][id]"]').forEach((function(e){i(e,"change",(function(e){var n=e.target.getAttribute("id"),c=document.querySelector('label[for="'.concat(n,'"]'));if(c){var o=c.querySelector("[data-shipping-method-label-title]").dataset.shippingMethodLabelTitle;a({event:"select shipping method",eventCategory:"checkout",eventLabel:o,attributes:t({},l())})}}))}))})):"payment_method"===window.Shopify.Checkout.step&&function(){document.querySelectorAll('input[name="checkout[payment_gateway]"]').forEach((function(e){i(e,"change",(function(e){var n=e.target.getAttribute("id"),c=document.querySelector('label[for="'.concat(n,'"]'));if(c){var o=c.textContent.trim();a({event:"select payment method",eventCategory:"checkout",eventLabel:o,attributes:t({},l())})}}))})),document.querySelectorAll('input[name="checkout[different_billing_address]"]').forEach((function(e){i(e,"change",(function(e){var n=e.target.getAttribute("id"),c=document.querySelector('label[for="'.concat(n,'"]'));if(c){var o=c.textContent.trim();a({event:"toggle billing address",eventCategory:"checkout",eventLabel:o,attributes:t({},l())})}}))}));var e=document.querySelector('input[name="checkout[remember_me]"].input-checkbox');i(e,"change",(function(e){a({event:"remember me",eventCategory:"checkout",eventLabel:e.target.checked,attributes:t({},l())})}))}()};r=function(){d(),new MutationObserver(d).observe(document.querySelector(".main__content"),{childList:!0})},"loading"!==document.readyState?r():document.addEventListener?document.addEventListener("DOMContentLoaded",r):document.attachEvent("onreadystatechange",(function(){"loading"!==document.readyState&&r()}))}();

</script>